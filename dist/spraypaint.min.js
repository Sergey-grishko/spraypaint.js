!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.spraypaint={})}(this,function(t){"use strict";var i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};function c(t,e){function r(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}var n=function(){return(n=Object.assign||function(t){for(var e,r=1,i=arguments.length;r<i;r++)for(var n in e=arguments[r])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)};function e(t,e,r,i){var n,s=arguments.length,o=s<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,r,i);else for(var a=t.length-1;0<=a;a--)(n=t[a])&&(o=(s<3?n(o):3<s?n(e,r,o):n(e,r))||o);return 3<s&&o&&Object.defineProperty(e,r,o),o}function s(t,o,a,c){return new(a=a||Promise)(function(r,e){function i(t){try{s(c.next(t))}catch(t){e(t)}}function n(t){try{s(c.throw(t))}catch(t){e(t)}}function s(t){var e;t.done?r(t.value):((e=t.value)instanceof a?e:new a(function(t){t(e)})).then(i,n)}s((c=c.apply(t,o||[])).next())})}function u(r,i){var n,s,o,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,s&&(o=2&e[0]?s.return:e[0]?s.throw||((o=s.return)&&o.call(s),0):s.next)&&!(o=o.call(s,e[1])).done)return o;switch(s=0,(e=o?[2&e[0],o.value]:e)[0]){case 0:case 1:o=e;break;case 4:return a.label++,{value:e[1],done:!1};case 5:a.label++,s=e[1],e=[0];continue;case 7:e=a.ops.pop(),a.trys.pop();continue;default:if(!(o=0<(o=a.trys).length&&o[o.length-1])&&(6===e[0]||2===e[0])){a=0;continue}if(3===e[0]&&(!o||e[1]>o[0]&&e[1]<o[3])){a.label=e[1];break}if(6===e[0]&&a.label<o[1]){a.label=o[1],o=e;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(e);break}o[2]&&a.ops.pop(),a.trys.pop();continue}e=i.call(r,a)}catch(t){e=[6,t],s=0}finally{n=o=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}var o=(r.apply=function(t,e){new r(t,e).apply()},r.prototype.apply=function(){var i=this,n={};this.payload.errors&&(this.payload.errors.forEach(function(t){var e=t.meta;if(!e)throw new Error("invalid json");var r=e.relationship;r?i._processRelationship(i.model,r,t):i._processResource(n,e,t)}),this.model.errors=n)},r.prototype._processResource=function(t,e,r){var i=this.model.klass.deserializeKey(e.attribute);t[i]={title:r.title,code:r.code,attribute:e.attribute,message:e.message,fullMessage:"base"===i?e.message:r.detail,rawPayload:r}},r.prototype._processRelationship=function(t,e,r){var i,n,s=t[t.klass.deserializeKey(e.name)];Array.isArray(s)&&(s=s.find(function(t){return t.id&&String(t.id)===String(e.id)||t.temp_id&&t.temp_id===e["temp-id"]})),e.relationship?this._processRelationship(s,e.relationship,r):(this._processResource(i={},e,r),n={},Object.keys(s.errors).forEach(function(t){n[t]=s.errors[t]}),Object.keys(i).forEach(function(t){var e=i[t];void 0!==e&&(n[t]=e)}),s.errors=n)},r);function r(t,e){this.model=t,this.payload=e}function a(t,e){(e=e.headers.get("X-JWT"))&&t.setJWT(e)}function l(t,e){if(h()){t=p[t];return"["+t[0]+"m"+e+"["+t[1]+"m"}return e}var p={green:[32,39],cyan:[36,39],magenta:[35,39],bold:[1,22]},h=function(){return!1},f=(d.prototype.get=function(t,e){return e.method="GET",this._fetchWithLogging(t,e)},d.prototype.post=function(t,e,r){return r.method="POST",r.body=JSON.stringify(e),this._fetchWithLogging(t,r)},d.prototype.patch=function(t,e,r){return this.config.patchAsPost?(r.method="POST",r.headers||(r.headers={}),r.headers["X-HTTP-Method-Override"]="PATCH"):r.method="PATCH",r.body=JSON.stringify(e),this._fetchWithLogging(t,r)},d.prototype.delete=function(t,e){return e.method="DELETE",this._fetchWithLogging(t,e)},d.prototype._logRequest=function(t,e){this.logger.info(l("cyan",t+": ")+l("magenta",e))},d.prototype._logResponse=function(t){this.logger.debug(l("bold",JSON.stringify(t,null,4)))},d.prototype._fetchWithLogging=function(r,i){return s(this,void 0,void 0,function(){var e;return u(this,function(t){switch(t.label){case 0:return this._logRequest(i.method||"UNDEFINED METHOD",r),[4,this._fetch(r,i)];case 1:return e=t.sent(),this._logResponse(e.jsonPayload),[2,e]}})})},d.prototype._fetch=function(i,n){return s(this,void 0,void 0,function(){var e,r;return u(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.middleware.beforeFetch(i,n)];case 1:return t.sent(),[3,3];case 2:throw r=t.sent(),new b("beforeFetch failed; review middleware.beforeFetch stack",i,n,r);case 3:return t.trys.push([3,5,,6]),[4,fetch(i,n)];case 4:return e=t.sent(),[3,6];case 5:throw r=t.sent(),new _(null,r.message,r);case 6:return[4,this._handleResponse(e,n)];case 7:return t.sent(),[2,e]}})})},d.prototype._handleResponse=function(i,n){return s(this,void 0,void 0,function(){var e,r;return u(this,function(t){switch(t.label){case 0:if("DELETE"===n.method&&-1<[204,200].indexOf(i.status))return[2];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,i.clone().json()];case 2:return e=t.sent(),[3,4];case 3:if(r=t.sent(),-1<[202,204].indexOf(i.status))return[2];throw new _(i,"invalid json",r);case 4:return t.trys.push([4,6,,7]),[4,this.middleware.afterFetch(i,e)];case 5:return t.sent(),[3,7];case 6:throw r=t.sent(),new _(i,"afterFetch failed; review middleware.afterFetch stack",r);case 7:if(500<=i.status)throw new _(i,"Server Error");if(422!==i.status&&void 0===e.data)throw 404===i.status?new _(i,"record not found"):new _(i,"invalid json");return i.jsonPayload=e,[2]}})})},d);function d(t,e,r){this.middleware=t,this.logger=e,this.config=Object.assign({patchAsPost:!1},r)}var y,b=(c(v,y=Error),v);function v(t,e,r,i){t=y.call(this,t)||this;return t.stack=i.stack,t.url=e,t.options=r,t.originalError=i,t}var g,_=(c(m,g=Error),m);function m(t,e,r){e=g.call(this,e||"Invalid Response")||this;return e.response=t,e.originalError=r,e}var j=(w.prototype.toScopeObject=function(){var t,e={};for(t in this.dct)this.dct.hasOwnProperty(t)&&(e[t]=this.dct[t].toScopeObject());return e},w.prototype.toString=function(){var t,r=[],i=this;for(t in this.dct)!function(e){var t;i.dct.hasOwnProperty(e)&&(""===(t=i.dct[e].toString())?r.push(e):(t=(t=t.split(",")).map(function(t){return e+"."+t}),r.push(t.join(","))))}(t);return r.join(",")},w.prototype._parseIncludeArgs=function(t){if(Array.isArray(t))return this._parseArray(t);if("string"!=typeof t)return"object"==typeof t?this._parseObject(t):{};var e={};return e[t]={},e},w.prototype._parseObject=function(t){var e,r={};for(e in t)t.hasOwnProperty(e)&&(r[e]=this._parseIncludeArgs(t[e]));return r},w.prototype._parseArray=function(t){for(var e={},r=0,i=t;r<i.length;r++){var n,s=i[r],o=this._parseIncludeArgs(s);for(n in o)o.hasOwnProperty(n)&&(e[n]=o[n])}return e},w);function w(t){this.dct={};var e,r=this._parseIncludeArgs(t);for(e in r)r.hasOwnProperty(e)&&(this.dct[e]=new w(r[e]))}var O=0,k=function(){return"temp-id-"+ ++O},A=(P.prototype.attributes=function(){var i=this,n={};return this._eachAttribute(function(t,e,r){i.model.isPersisted&&!i.model.changes()[t]||(t=i.model.klass.serializeKey(t),r.type===Number&&""===e?n[t]=null:n[t]=e)}),n},P.prototype.removeDeletions=function(e,s){var o=this;Object.keys(s).forEach(function(r){var i=s[r],n=e,t=n[r];t&&(Array.isArray(t)?t.forEach(function(t,e){t.isMarkedForDestruction||t.isMarkedForDisassociation?n[r].splice(e,1):o.removeDeletions(t,i)}):(t=t).isMarkedForDestruction||t.isMarkedForDisassociation?n[r]=null:o.removeDeletions(t,i))})},P.prototype.postProcess=function(){this.removeDeletions(this.model,this.includeDirective),this.model.resetRelationTracking(this.includeDirective)},P.prototype.relationships=function(){var s=this,o={};return Object.keys(this.includeDirective).forEach(function(e){var r,i=s.includeDirective[e],n=!1;-1<e.indexOf(".")&&(e=e.split(".")[0],n=!0);var t=s.model[e];t&&(Array.isArray(t)?(r=[],t.forEach(function(t){!s._isNewAndMarkedForDestruction(t)&&(n||s.model.hasDirtyRelation(e,t)||t.isDirty(i))&&r.push(s._processRelatedModel(t,i,n))}),0===r.length&&(r=null)):!s._isNewAndMarkedForDestruction(t)&&(n||s.model.hasDirtyRelation(e,t)||t.isDirty(i))&&(r=s._processRelatedModel(t,i,n)),r&&(o[s.model.klass.serializeKey(e)]={data:r}))}),o},P.prototype.asJSON=function(){var t={type:this.jsonapiType};this.model.id&&(t.id=this.model.id),this.model.temp_id&&(t["temp-id"]=this.model.temp_id),this.idOnly||(r=this.attributes(),0<Object.keys(r).length&&(t.attributes=r));var e=this.relationships();0<Object.keys(e).length&&(t.relationships=e);var r={data:t};0<this.included.length&&(r.included=this.included);e=this.model.meta;return this.model.isMetaDirty&&0<Object.keys(e).length&&(t.meta=e),r},P.prototype._isNewAndMarkedForDestruction=function(t){return!t.isPersisted&&t.isMarkedForDestruction},P.prototype._processRelatedModel=function(e,t,r){var i=this;e.clearErrors(),e.isPersisted||(e.temp_id=k());t=new P(e,t,r),r=t.asJSON().data;return this._isNewAndMarkedForDestruction(e)||this._pushInclude(r),t.included.forEach(function(t){i._isNewAndMarkedForDestruction(e)||i._pushInclude(t)}),this._resourceIdentifierFor(e)},P.prototype._resourceIdentifierFor=function(t){if(!t.klass.jsonapiType)throw new Error("Cannot serialize model: Undefined jsonapiType for model "+t);var e={type:t.klass.jsonapiType};return t.id&&(e.id=t.id),t.temp_id&&(e["temp-id"]=t.temp_id),t=t.isPersisted?t.isMarkedForDestruction?"destroy":t.isMarkedForDisassociation?"disassociate":"update":"create",e.method=t,e},P.prototype._pushInclude=function(t){this._isIncluded(t)||this.included.push(t)},P.prototype._isIncluded=function(e){return this.included.forEach(function(t){if(t.type===e.type&&(t.id===e.id||t["temp-id"]===e["temp-id"]))return!0}),!1},P.prototype._eachAttribute=function(i){var n=this,s=this.model.typedAttributes;Object.keys(s).forEach(function(t){var e,r=n.model.klass.attributeList[t];r.persist&&(e=s[t],i(t,e,r))})},P);function P(t,e,r){void 0===r&&(r=!1),this.included=[],this.idOnly=!1;e=new j(e);if(this.includeDirective=e.toScopeObject(),this.model=t,this.idOnly=r,!t.klass.jsonapiType)throw new Error("Cannot serialize model: Undefined jsonapiType");this.jsonapiType=t.klass.jsonapiType}var C,S=($.prototype.getItem=function(t){return this._data[t]||null},$.prototype.setItem=function(t,e){this._data[t]=e},$.prototype.removeItem=function(t){delete this._data[t]},$);function $(){this._data={}}try{C=localStorage}catch(t){C=new S}var R=(Object.defineProperty(E.prototype,"backend",{get:function(){return this._backend},enumerable:!0,configurable:!0}),E.prototype.getJWT=function(){return this._backend.getItem(this._jwtKey)||void 0},E.prototype.setJWT=function(t){t?this._backend.setItem(this._jwtKey,t):this._backend.removeItem(this._jwtKey)},E);function E(t,e){void 0===e&&(e=C),this._jwtKey=t,this._backend=e}function x(t,e){return t===e||t!=t&&e!=e}function F(t,e){for(var r=t.length;r--;)if(x(t[r][0],e))return r;return-1}var D=Array.prototype.splice;function T(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var i=t[e];this.set(i[0],i[1])}}T.prototype.clear=function(){this.__data__=[],this.size=0},T.prototype.delete=function(t){var e=this.__data__;return!((t=F(e,t))<0)&&(t==e.length-1?e.pop():D.call(e,t,1),--this.size,!0)},T.prototype.get=function(t){var e=this.__data__;return(t=F(e,t))<0?void 0:e[t][1]},T.prototype.has=function(t){return-1<F(this.__data__,t)},T.prototype.set=function(t,e){var r=this.__data__,i=F(r,t);return i<0?(++this.size,r.push([t,e])):r[i][1]=e,this};var z="object"==typeof global&&global&&global.Object===Object&&global,I="object"==typeof self&&self&&self.Object===Object&&self,L=z||I||Function("return this")(),M=L.Symbol,U=Object.prototype,N=U.hasOwnProperty,B=U.toString,J=M?M.toStringTag:void 0;var K=Object.prototype.toString;var W="[object Null]",H="[object Undefined]",q=M?M.toStringTag:void 0;function G(t){return null==t?void 0===t?H:W:q&&q in Object(t)?function(t){var e=N.call(t,J),r=t[J];try{var i=!(t[J]=void 0)}catch(t){}var n=B.call(t);return i&&(e?t[J]=r:delete t[J]),n}(t):K.call(t)}function Z(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}var V="[object AsyncFunction]",Q="[object Function]",Y="[object GeneratorFunction]",X="[object Proxy]";function tt(t){if(Z(t)){t=G(t);return t==Q||t==Y||t==V||t==X}}var et=L["__core-js_shared__"],rt=(At=/[^.]+$/.exec(et&&et.keys&&et.keys.IE_PROTO||""))?"Symbol(src)_1."+At:"";var it=Function.prototype.toString;function nt(t){if(null!=t){try{return it.call(t)}catch(t){}try{return t+""}catch(t){}}return""}var st=/^\[object .+?Constructor\]$/,ot=Function.prototype,I=Object.prototype,U=ot.toString,et=I.hasOwnProperty,at=RegExp("^"+U.call(et).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function ct(t){var e;return Z(t)&&(e=t,!(rt&&rt in e))&&(tt(t)?at:st).test(nt(t))}function ut(t,e){e=e,e=null==(t=t)?void 0:t[e];return ct(e)?e:void 0}var lt=ut(L,"Map"),pt=ut(Object,"create");var ht=Object.prototype.hasOwnProperty;var ft=Object.prototype.hasOwnProperty;function dt(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var i=t[e];this.set(i[0],i[1])}}function yt(t,e){var r,i=t.__data__;return("string"==(t=typeof(r=e))||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==r:null===r)?i["string"==typeof e?"string":"hash"]:i.map}function bt(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var i=t[e];this.set(i[0],i[1])}}dt.prototype.clear=function(){this.__data__=pt?pt(null):{},this.size=0},dt.prototype.delete=function(t){return t=this.has(t)&&delete this.__data__[t],this.size-=t?1:0,t},dt.prototype.get=function(t){var e=this.__data__;if(pt){var r=e[t];return"__lodash_hash_undefined__"===r?void 0:r}return ht.call(e,t)?e[t]:void 0},dt.prototype.has=function(t){var e=this.__data__;return pt?void 0!==e[t]:ft.call(e,t)},dt.prototype.set=function(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=pt&&void 0===e?"__lodash_hash_undefined__":e,this},bt.prototype.clear=function(){this.size=0,this.__data__={hash:new dt,map:new(lt||T),string:new dt}},bt.prototype.delete=function(t){return t=yt(this,t).delete(t),this.size-=t?1:0,t},bt.prototype.get=function(t){return yt(this,t).get(t)},bt.prototype.has=function(t){return yt(this,t).has(t)},bt.prototype.set=function(t,e){var r=yt(this,t),i=r.size;return r.set(t,e),this.size+=r.size==i?0:1,this};function vt(t){t=this.__data__=new T(t);this.size=t.size}vt.prototype.clear=function(){this.__data__=new T,this.size=0},vt.prototype.delete=function(t){var e=this.__data__,t=e.delete(t);return this.size=e.size,t},vt.prototype.get=function(t){return this.__data__.get(t)},vt.prototype.has=function(t){return this.__data__.has(t)},vt.prototype.set=function(t,e){var r=this.__data__;if(r instanceof T){var i=r.__data__;if(!lt||i.length<199)return i.push([t,e]),this.size=++r.size,this;r=this.__data__=new bt(i)}return r.set(t,e),this.size=r.size,this};var gt=function(){try{var t=ut(Object,"defineProperty");return t({},"",{}),t}catch(t){}}();function _t(t,e,r){"__proto__"==e&&gt?gt(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r}var mt=Object.prototype.hasOwnProperty;function jt(t,e,r){var i=t[e];mt.call(t,e)&&x(i,r)&&(void 0!==r||e in t)||_t(t,e,r)}function wt(t,e,r,i){var n=!r;r=r||{};for(var s=-1,o=e.length;++s<o;){var a=e[s],c=i?i(r[a],t[a],a,r,t):void 0;(n?_t:jt)(r,a,c=void 0===c?t[a]:c)}return r}function Ot(t){return null!=t&&"object"==typeof t}function kt(t){return Ot(t)&&"[object Arguments]"==G(t)}var At=Object.prototype,Pt=At.hasOwnProperty,Ct=At.propertyIsEnumerable,St=kt(function(){return arguments}())?kt:function(t){return Ot(t)&&Pt.call(t,"callee")&&!Ct.call(t,"callee")},$t=Array.isArray;var ot="object"==typeof t&&t&&!t.nodeType&&t,I=ot&&"object"==typeof module&&module&&!module.nodeType&&module,U=I&&I.exports===ot?L.Buffer:void 0,Rt=(U?U.isBuffer:void 0)||function(){return!1},Et=9007199254740991,xt=/^(?:0|[1-9]\d*)$/;var Ft=9007199254740991;function Dt(t){return"number"==typeof t&&-1<t&&t%1==0&&t<=Ft}var Tt={};function zt(e){return function(t){return e(t)}}Tt["[object Float32Array]"]=Tt["[object Float64Array]"]=Tt["[object Int8Array]"]=Tt["[object Int16Array]"]=Tt["[object Int32Array]"]=Tt["[object Uint8Array]"]=Tt["[object Uint8ClampedArray]"]=Tt["[object Uint16Array]"]=Tt["[object Uint32Array]"]=!0,Tt["[object Arguments]"]=Tt["[object Array]"]=Tt["[object ArrayBuffer]"]=Tt["[object Boolean]"]=Tt["[object DataView]"]=Tt["[object Date]"]=Tt["[object Error]"]=Tt["[object Function]"]=Tt["[object Map]"]=Tt["[object Number]"]=Tt["[object Object]"]=Tt["[object RegExp]"]=Tt["[object Set]"]=Tt["[object String]"]=Tt["[object WeakMap]"]=!1;var et="object"==typeof t&&t&&!t.nodeType&&t,It=et&&"object"==typeof module&&module&&!module.nodeType&&module,Lt=It&&It.exports===et&&z.process,At=function(){try{var t=It&&It.require&&It.require("util").types;return t?t:Lt&&Lt.binding&&Lt.binding("util")}catch(t){}}(),I=At&&At.isTypedArray,Mt=I?zt(I):function(t){return Ot(t)&&Dt(t.length)&&!!Tt[G(t)]},Ut=Object.prototype.hasOwnProperty;function Nt(t,e){var r,i,n,s,o=$t(t),a=!o&&St(t),c=!o&&!a&&Rt(t),u=!o&&!a&&!c&&Mt(t),l=o||a||c||u,p=l?function(t,e){for(var r=-1,i=Array(t);++r<t;)i[r]=e(r);return i}(t.length,String):[],h=p.length;for(r in t)!e&&!Ut.call(t,r)||l&&("length"==r||c&&("offset"==r||"parent"==r)||u&&("buffer"==r||"byteLength"==r||"byteOffset"==r)||(s=void 0,s=typeof(i=r),(n=null==(n=h)?Et:n)&&("number"==s||"symbol"!=s&&xt.test(i))&&-1<i&&i%1==0&&i<n))||p.push(r);return p}var Bt=Object.prototype;function Jt(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||Bt)}function Kt(e,r){return function(t){return e(r(t))}}var Wt=Kt(Object.keys,Object),Ht=Object.prototype.hasOwnProperty;function qt(t){if(!Jt(t))return Wt(t);var e,r=[];for(e in Object(t))Ht.call(t,e)&&"constructor"!=e&&r.push(e);return r}function Gt(t){return null!=t&&Dt(t.length)&&!tt(t)}function Zt(t){return(Gt(t)?Nt:qt)(t)}var Vt=Object.prototype.hasOwnProperty;function Qt(t){if(!Z(t))return function(t){var e=[];if(null!=t)for(var r in Object(t))e.push(r);return e}(t);var e,r=Jt(t),i=[];for(e in t)("constructor"!=e||!r&&Vt.call(t,e))&&i.push(e);return i}function Yt(t){return Gt(t)?Nt(t,!0):Qt(t)}var ot="object"==typeof t&&t&&!t.nodeType&&t,U=ot&&"object"==typeof module&&module&&!module.nodeType&&module,et=U&&U.exports===ot?L.Buffer:void 0,Xt=et?et.allocUnsafe:void 0;function te(){return[]}var ee=Object.prototype.propertyIsEnumerable,re=Object.getOwnPropertySymbols,ie=re?function(e){return null==e?[]:(e=Object(e),function(t,e){for(var r=-1,i=null==t?0:t.length,n=0,s=[];++r<i;){var o=t[r];e(o,r,t)&&(s[n++]=o)}return s}(re(e),function(t){return ee.call(e,t)}))}:te;function ne(t,e){for(var r=-1,i=e.length,n=t.length;++r<i;)t[n+r]=e[r];return t}var se=Kt(Object.getPrototypeOf,Object),oe=Object.getOwnPropertySymbols?function(t){for(var e=[];t;)ne(e,ie(t)),t=se(t);return e}:te;function ae(t,e,r){e=e(t);return $t(t)?e:ne(e,r(t))}function ce(t){return ae(t,Zt,ie)}function ue(t){return ae(t,Yt,oe)}var z=ut(L,"DataView"),I=ut(L,"Promise"),U=ut(L,"Set"),ot=ut(L,"WeakMap"),le="[object Map]",pe="[object Promise]",he="[object Set]",fe="[object WeakMap]",de="[object DataView]",ye=nt(z),be=nt(lt),ve=nt(I),ge=nt(U),_e=nt(ot),et=G,me=et=z&&et(new z(new ArrayBuffer(1)))!=de||lt&&et(new lt)!=le||I&&et(I.resolve())!=pe||U&&et(new U)!=he||ot&&et(new ot)!=fe?function(t){var e=G(t),t="[object Object]"==e?t.constructor:void 0,t=t?nt(t):"";if(t)switch(t){case ye:return de;case be:return le;case ve:return pe;case ge:return he;case _e:return fe}return e}:et,je=Object.prototype.hasOwnProperty;var we=L.Uint8Array;function Oe(t){var e=new t.constructor(t.byteLength);return new we(e).set(new we(t)),e}var ke=/\w*$/;var L=M?M.prototype:void 0,Ae=L?L.valueOf:void 0;var Pe="[object Boolean]",Ce="[object Date]",Se="[object Map]",$e="[object Number]",Re="[object RegExp]",Ee="[object Set]",xe="[object String]",Fe="[object Symbol]",De="[object ArrayBuffer]",Te="[object DataView]",ze="[object Float32Array]",Ie="[object Float64Array]",Le="[object Int8Array]",Me="[object Int16Array]",Ue="[object Int32Array]",Ne="[object Uint8Array]",Be="[object Uint8ClampedArray]",Je="[object Uint16Array]",Ke="[object Uint32Array]";function We(t,e,r){var i,n,s,o,a=t.constructor;switch(e){case De:return Oe(t);case Pe:case Ce:return new a(+t);case Te:return s=t,o=r,o=r?Oe(s.buffer):s.buffer,new s.constructor(o,s.byteOffset,s.byteLength);case ze:case Ie:case Le:case Me:case Ue:case Ne:case Be:case Je:case Ke:return n=t,s=r,s=r?Oe(n.buffer):n.buffer,new n.constructor(s,n.byteOffset,n.length);case Se:return new a;case $e:case xe:return new a(t);case Re:return(i=new(n=t).constructor(n.source,ke.exec(n))).lastIndex=n.lastIndex,i;case Ee:return new a;case Fe:return i=t,Ae?Object(Ae.call(i)):{}}}var He=Object.create,qe=function(t){if(!Z(t))return{};if(He)return He(t);Ge.prototype=t;t=new Ge;return Ge.prototype=void 0,t};function Ge(){}var M=At&&At.isMap,Ze=M?zt(M):function(t){return Ot(t)&&"[object Map]"==me(t)};var L=At&&At.isSet,Ve=L?zt(L):function(t){return Ot(t)&&"[object Set]"==me(t)},Qe=1,Ye=2,Xe=4,tr="[object Arguments]",er="[object Function]",rr="[object GeneratorFunction]",ir="[object Object]",nr={};function sr(r,i,n,t,e,s){var o,a=i&Qe,c=i&Ye,u=i&Xe;if(void 0!==(o=n?e?n(r,t,e,s):n(r):o))return o;if(!Z(r))return r;var l,p,h,f,d,y=$t(r);if(y){if(b=(f=r).length,d=new f.constructor(b),b&&"string"==typeof f[0]&&je.call(f,"index")&&(d.index=f.index,d.input=f.input),o=d,!a)return function(t,e){var r=-1,i=t.length;for(e=e||Array(i);++r<i;)e[r]=t[r];return e}(r,o)}else{var t=me(r),b=t==er||t==rr;if(Rt(r))return f=r,(d=a)?f.slice():(d=f.length,d=Xt?Xt(d):new f.constructor(d),f.copy(d),d);if(t==ir||t==tr||b&&!e){if(o=c||b?{}:"function"!=typeof(b=r).constructor||Jt(b)?{}:qe(se(b)),!a)return c?(h=l=r,h=(p=o)&&wt(h,Yt(h),p),wt(l,oe(l),h)):(l=p=r,h=(h=o)&&wt(l,Zt(l),h),wt(p,ie(p),h))}else{if(!nr[t])return e?r:{};o=We(r,t,a)}}a=(s=s||new vt).get(r);if(a)return a;s.set(r,o),Ve(r)?r.forEach(function(t){o.add(sr(t,i,n,t,r,s))}):Ze(r)&&r.forEach(function(t,e){o.set(e,sr(t,i,n,e,r,s))});var v=y?void 0:(u?c?ue:ce:c?Yt:Zt)(r);return function(t,e){for(var r=-1,i=null==t?0:t.length;++r<i&&!1!==e(t[r],r,t););}(v||r,function(t,e){v&&(t=r[e=t]),jt(o,e,sr(t,i,n,e,r,s))}),o}nr[tr]=nr["[object Array]"]=nr["[object ArrayBuffer]"]=nr["[object DataView]"]=nr["[object Boolean]"]=nr["[object Date]"]=nr["[object Float32Array]"]=nr["[object Float64Array]"]=nr["[object Int8Array]"]=nr["[object Int16Array]"]=nr["[object Int32Array]"]=nr["[object Map]"]=nr["[object Number]"]=nr[ir]=nr["[object RegExp]"]=nr["[object Set]"]=nr["[object String]"]=nr["[object Symbol]"]=nr["[object Uint8Array]"]=nr["[object Uint8ClampedArray]"]=nr["[object Uint16Array]"]=nr["[object Uint32Array]"]=!0,nr["[object Error]"]=nr[er]=nr["[object WeakMap]"]=!1;var or=1,ar=4;function cr(t){return sr(t,or|ar)}var ur,M=(function(t){t.exports=(t={},(t=function(){this.listeners={}}).prototype={addEventListener:function(t,e,r){for(var i=[],n=arguments.length,s=0;s<n;s++)i.push(arguments[s]);i=3<i.length?i.splice(3,i.length-1):[],void 0!==this.listeners[t]?this.listeners[t].push({scope:r,callback:e,args:i}):this.listeners[t]=[{scope:r,callback:e,args:i}]},removeEventListener:function(t,e,r){if(void 0!==this.listeners[t]){for(var i=this.listeners[t].length,n=[],s=0;s<i;s++){var o=this.listeners[t][s];o.scope==r&&o.callback==e||n.push(o)}this.listeners[t]=n}},hasEventListener:function(t,e,r){if(void 0!==this.listeners[t]){var i=this.listeners[t].length;if(void 0===e&&void 0===r)return 0<i;for(var n=0;n<i;n++){var s=this.listeners[t][n];if((!r||s.scope==r)&&s.callback==e)return!0}}return!1},dispatch:function(t,e){for(var e={type:t,target:e},r=[],i=arguments.length,n=0;n<i;n++)r.push(arguments[n]);if(r=2<r.length?r.splice(2,r.length-1):[],r=[e].concat(r),void 0!==this.listeners[t])for(var s=this.listeners[t].slice(),o=s.length,n=0;n<o;n++){var a,c=s[n];c&&c.callback&&(a=r.concat(c.args),c.callback.apply(c.scope,a))}},getEvents:function(){var t,e="";for(t in this.listeners)for(var r=this.listeners[t].length,i=0;i<r;i++){var n=this.listeners[t][i];e+=n.scope&&n.scope.className?n.scope.className:"anonymous",e+=" listen for '"+t+"'\n"}return e}},new t)}(ur={exports:{}}),ur.exports),lr=Object.freeze({default:M,__moduleExports:M}),pr=(Object.defineProperty(hr.prototype,"count",{get:function(){return Object.keys(this.data).length},enumerable:!0,configurable:!0}),hr.prototype.find=function(t,e){return e=(e=void 0===e?null:e)||t.storeKey,this.data[e]},hr.prototype.findAll=function(t){var e=this,r=[];return t.forEach(function(t){t=e.find(t);t&&r.push(t)}),r},hr.prototype.create=function(t,e){t.storeKey=e,t.stale=!1,this.data[e]=cr(t.attributes)},hr.prototype.updateOrCreate=function(t){var e;t.storeKey?this.create(t,t.storeKey):(e=this.keyFor(t),this.create(t,e)),lr.dispatch(t.storeKey,{},this.data[t.storeKey])},hr.prototype.destroy=function(t){t.stale=!0,delete this.data[t.storeKey]},hr.prototype.keyFor=function(t){return t.klass.jsonapiType+"-"+t.id},hr);function hr(){this.data={}}var fr=(dr.prototype.addResources=function(t){if(t)if(Array.isArray(t))for(var e=0,r=t;e<r.length;e++){var i=r[e];this._resources.push(i)}else this._resources.push(t)},dr.prototype.instanceFor=function(t){var e=this.registry.get(t);if(!e)throw new Error('Unknown type "'+t+'"');return new e},dr.prototype.relationshipInstanceFor=function(e,t){return t.find(function(t){return!(t.klass.jsonapiType!==e.type||!(t.id&&e.id&&t.id===e.id||t.temp_id&&e["temp-id"]&&t.temp_id===e["temp-id"]))})||this.instanceFor(e.type)},dr.prototype.lookupAssociated=function(t,e){return t.find(function(t){return!(t.klass.jsonapiType!==e.klass.jsonapiType||!(t.temp_id&&e.temp_id&&t.temp_id===e.temp_id||t.id&&e.id&&t.id===e.id))})},dr.prototype.pushRelation=function(t,e,r){var i=t,t=i[e];this.lookupAssociated(t,r)||i[e].push(r)},dr.prototype.deserialize=function(t){var e=this.instanceFor(t.type);return this.deserializeInstance(e,t,{})},dr.prototype.deserializeInstance=function(t,e,r){void 0===r&&(r={});var i=this.alreadyDeserialized(e);return i||(t.id=e.id,t.temp_id=e["temp-id"],t.assignAttributes(e.attributes),t.assignLinks(e.links),t.setMeta(e.meta,!1),this._deserialized.push(t),this._processRelationships(t,e.relationships||{},r),this._removeDeletions(t,r),t.isPersisted=!0,t.reset(),t)},dr.prototype._removeDeletions=function(e,n){var s=this;Object.keys(n).forEach(function(r){var i=e,t=i[r];t&&(Array.isArray(t)?t.forEach(function(t,e){t.isMarkedForDestruction?i.klass.store.destroy(t):t.isMarkedForDisassociation?i[r].splice(e,1):s._removeDeletions(t,n[r]||{})}):(t=t).isMarkedForDestruction?i.klass.store.destroy(t):t.isMarkedForDisassociation?i[r]=null:s._removeDeletions(t,n[r]||{}))})},dr.prototype._processRelationships=function(u,t,l){var p=this;this._iterateValidRelationships(u,t,function(t,e){var r=l[t],i=u;if(Array.isArray(e))for(var n=0,s=e;n<s.length;n++){var o=s[n],a=p.findResource(o),o=i[t],o=p.relationshipInstanceFor(a,o),o=p.deserializeInstance(o,a,r);p.pushRelation(u,t,o)}else{var a=p.findResource(e),c=i[t],e=c||p.instanceFor(a.type),e=p.deserializeInstance(e,a,r);c||(i[t]=e)}})},dr.prototype._iterateValidRelationships=function(t,e,r){for(var i in e){var n;e.hasOwnProperty(i)&&(n=t.klass.deserializeKey(i),!t.klass.attributeList[n]||(i=e[i].data)&&r(n,i))}},dr.prototype.alreadyDeserialized=function(e){return this._deserialized.find(function(t){return!(t.klass.jsonapiType!==e.type||!(t.id&&e.id&&t.id===e.id||t.temp_id&&e.temp_id&&t.temp_id===e["temp-id"]))})},dr.prototype.findResource=function(e){return this._resources.find(function(t){return!(t.type!==e.type||!(t.id&&e.id&&t.id===e.id||t["temp-id"]&&e["temp-id"]&&t["temp-id"]===e["temp-id"]))})||e},dr);function dr(t,e){this._deserialized=[],this._resources=[],this.registry=t,this.payload=e,this.addResources(e.data),this.addResources(e.included)}var yr=Object.prototype.hasOwnProperty;var br=(vr.prototype.checkRelation=function(t,e){var r=!1;return e.isPersisted&&((this.model._originalRelationships[t]||[]).find(function(t){return JSON.stringify(t)===JSON.stringify(e.resourceIdentifier)})||(r=!0)),r},vr.prototype.check=function(t){t=new j(t=void 0===t?{}:t).toScopeObject();return this._hasDirtyAttributes()||this._hasDirtyRelationships(t)||this.model.isMarkedForDestruction||this.model.isMarkedForDisassociation||this._isUnpersisted()},vr.prototype.dirtyAttributes=function(){for(var t={},e=0,r=Object.keys(this.model.attributes);e<r.length;e++){var i=r[e],n=this.model._originalAttributes[i],s=this.model.attributes[i],o=this.model.klass.attributeList[i];this.model.isPersisted?o.dirtyChecker(n,s)&&(t[i]=[n,s]):t[i]=[null,s]}return t},vr.prototype._isUnpersisted=function(){return!this.model.isPersisted&&JSON.stringify(this.model.attributes)!==JSON.stringify({})},vr.prototype._hasDirtyAttributes=function(){return!function(t){if(null==t)return 1;if(Gt(t)&&($t(t)||"string"==typeof t||"function"==typeof t.splice||Rt(t)||Mt(t)||St(t)))return!t.length;var e,r=me(t);if("[object Map]"==r||"[object Set]"==r)return!t.size;if(Jt(t))return!qt(t).length;for(e in t)if(yr.call(t,e))return;return 1}(this.dirtyAttributes())},vr.prototype._hasDirtyRelationships=function(t){var i=this,n=!1;return this._eachRelatedObject(t,function(t,e,r){e.isDirty(r)&&(n=!0),i.checkRelation(t,e)&&(n=!0)}),n},vr.prototype._eachRelatedObject=function(i,n){var s=this;Object.keys(i).forEach(function(e){var r=i[e],t=s.model[e];(t=!Array.isArray(t)?[t]:t).forEach(function(t){t&&n(e,t,r)})})},vr);function vr(t){this.model=t}var gr=function(t,e){var r,i,n=[];for(r in t)!t.hasOwnProperty(r)||null!=(i=t[r])&&""!==i&&(e&&(r=e+"["+r+"]"),Array.isArray(i)?0<(i=i.map(function(t){return _r(t)})).length&&n.push(r+"="+i.join(",")):"object"==typeof i?n.push(gr(i,r)):n.push(r+"="+_r(i)));return(n=n.filter(function(t){return!!t})).join("&")},_r=function(t){var e="undefined"!=typeof document,r=e&&window.navigator.userAgent.match(/(MSIE|Trident)/),i="string"==typeof t&&-1!==t.indexOf("%");return e&&r&&!i?encodeURIComponent(t):t},mr=(Object.defineProperty(jr.prototype,"raw",{get:function(){return this._raw_json},enumerable:!0,configurable:!0}),Object.defineProperty(jr.prototype,"data",{get:function(){return this._collection},enumerable:!0,configurable:!0}),Object.defineProperty(jr.prototype,"meta",{get:function(){return this.raw.meta||{}},enumerable:!0,configurable:!0}),jr);function jr(t,e){void 0===e&&(e={data:[]}),this._collection=t,this._raw_json=e}var wr=(Object.defineProperty(Or.prototype,"raw",{get:function(){return this._raw_json},enumerable:!0,configurable:!0}),Object.defineProperty(Or.prototype,"data",{get:function(){return this._record},enumerable:!0,configurable:!0}),Object.defineProperty(Or.prototype,"meta",{get:function(){return this.raw.meta||{}},enumerable:!0,configurable:!0}),Or);function Or(t,e){this._record=t,this._raw_json=e}var kr=(Object.defineProperty(Ar.prototype,"raw",{get:function(){return this._raw_json},enumerable:!0,configurable:!0}),Object.defineProperty(Ar.prototype,"data",{get:function(){return null},enumerable:!0,configurable:!0}),Object.defineProperty(Ar.prototype,"meta",{get:function(){return this.raw.meta||{}},enumerable:!0,configurable:!0}),Ar);function Ar(t){this._raw_json=t}var Pr=(Cr.prototype.all=function(){return s(this,void 0,void 0,function(){var e;return u(this,function(t){switch(t.label){case 0:return[4,this._fetch(this.model.url())];case 1:return e=t.sent(),[2,this._buildCollectionResult(e)]}})})},Cr.prototype.find=function(r){return s(this,void 0,void 0,function(){var e;return u(this,function(t){switch(t.label){case 0:return[4,this._fetch(this.model.url(r))];case 1:return e=t.sent(),[2,this._buildRecordResult(e)]}})})},Cr.prototype.first=function(){return s(this,void 0,void 0,function(){var e;return u(this,function(t){switch(t.label){case 0:return[4,(e=this.per(1))._fetch(e.model.url())];case 1:return e=t.sent(),[2,this._buildRecordResult(e)]}})})},Cr.prototype.merge=function(r){var i=this,n=this.copy();return Object.keys(r).forEach(function(t){var e=i.model.serializeKey(t);n._associations[e]=r[t]}),n},Cr.prototype.page=function(t){var e=this.copy();return e._pagination.number=t,e},Cr.prototype.per=function(t){var e=this.copy();return e._pagination.size=t,e},Cr.prototype.where=function(t){var e,r=this.copy();for(e in t=this._serverCasedWhereClause(t))t.hasOwnProperty(e)&&(r._filter[e]=t[e]);return r},Cr.prototype.extraParams=function(t){var e,r=this.copy();for(e in t)t.hasOwnProperty(e)&&(r._extraParams[e]=t[e]);return r},Cr.prototype.stats=function(t){var e,r=this.copy();for(e in t=this._serverCasedStatsClause(t))t.hasOwnProperty(e)&&(r._stats[e]=t[e]);return r},Cr.prototype.order=function(t){var e=this.copy();if("object"==typeof(t=this._serverCasedOrderClause(t)))for(var r in t)t.hasOwnProperty(r)&&(e._sort[r]=t[r]);else e._sort[t]="asc";return e},Cr.prototype.select=function(t){var e=this.copy();if(t=this._serverCasedFieldsClause(t),Array.isArray(t)){var r=this.model.jsonapiType;e._fields[r]=t}else for(var i in t)t.hasOwnProperty(i)&&(e._fields[i]=t[i]);return e},Cr.prototype.selectExtra=function(t){var e=this.copy();if(t=this._serverCasedFieldsClause(t),Array.isArray(t)){var r=this.model.jsonapiType;e._extra_fields[r]=t}else for(var i in t)t.hasOwnProperty(i)&&(e._extra_fields[i]=t[i]);return e},Cr.prototype.includes=function(t){var e=this.copy();t=this._serverCasedIncludesClause(t);var r,i=new j(t).toScopeObject();for(r in i)i.hasOwnProperty(r)&&(e._include[r]=i[r]);return e},Cr.prototype.extraFetchOptions=function(t){var e,r=this.copy();for(e in t)t.hasOwnProperty(e)&&(r._extraFetchOptions[e]=t[e]);return r},Cr.prototype.scope=function(){return this},Cr.prototype.asQueryParams=function(){var e=this,r={page:this._pagination,filter:this._filter,sort:this._sortParam(this._sort)||[],fields:this._fields,extra_fields:this._extra_fields,stats:this._stats,include:new j(this._include).toString()};return this._mergeAssociationQueryParams(r,this._associations),Object.keys(this._extraParams).forEach(function(t){r[t]=e._extraParams[t]}),r},Cr.prototype.toQueryParams=function(){var t=gr(this.asQueryParams());if(""!==t)return t},Cr.prototype.fetchOptions=function(){return n({},this.model.fetchOptions(),this._extraFetchOptions)},Cr.prototype.copy=function(){return cr(this)},Cr.prototype._mergeAssociationQueryParams=function(r,i){var t,n=this;for(t in i)!function(e){var t;i.hasOwnProperty(e)&&(t=i[e].asQueryParams(),r.page[e]=t.page,r.filter[e]=t.filter,r.stats[e]=t.stats,Object.assign(r.fields,t.fields),Object.assign(r.extra_fields,t.extra_fields),t.sort.forEach(function(t){t=n._transformAssociationSortParam(e,t);r.sort.push(t)}))}(t)},Cr.prototype._transformAssociationSortParam=function(t,e){return-1!==e.indexOf("-")&&(e=e.replace("-",""),t="-"+t),t+"."+e},Cr.prototype._sortParam=function(t){if(t&&0<Object.keys(t).length){var e,r=[];for(e in t)t.hasOwnProperty(e)&&("asc"!==t[e]&&(e="-"+e),r.push(e));return r}},Cr.prototype._fetch=function(r){return s(this,void 0,void 0,function(){var e;return u(this,function(t){switch(t.label){case 0:return(e=this.toQueryParams())&&(r=r+"?"+e),[4,new f(this.model.middlewareStack,this.model.logger).get(r,this.fetchOptions())];case 1:return e=t.sent(),a(this.model,e),[2,e.jsonPayload]}})})},Cr.prototype._buildRecordResult=function(t){var e;if(t.data instanceof Array){if(!(e=t.data[0]))return new kr(t)}else e=t.data;return e=this.model.fromJsonapi(e,t),new wr(e,t)},Cr.prototype._buildCollectionResult=function(e){var r=this,i=[];return e.data.forEach(function(t){i.push(r.model.fromJsonapi(t,e))}),new mr(i,e)},Cr.prototype._serverCasedWhereClause=function(t){return this._serverCasedClause(t,!1)},Cr.prototype._serverCasedOrderClause=function(t){return"string"==typeof t?this._serverCasedClause(t,!0):this._serverCasedClause(t,!1)},Cr.prototype._serverCasedFieldsClause=function(t){return this._serverCasedClause(t,!0)},Cr.prototype._serverCasedIncludesClause=function(t){return this._serverCasedClause(t,!0)},Cr.prototype._serverCasedStatsClause=function(t){return this._serverCasedClause(t,!0)},Cr.prototype._serverCasedClause=function(t,e){var r=this;if(void 0===e&&(e=!1),"string"==typeof t)return e?this.model.serializeKey(t):t;if(t instanceof Array)return t.map(function(t){return r._serverCasedClause(t,e)});if(t instanceof Object){var i,n,s,o={};for(i in t)t.hasOwnProperty(i)&&(n=this.model.serializeKey(i),s=this._serverCasedClause(t[i],e),o[n]=s);return o}return t},Cr);function Cr(t){this._associations={},this._pagination={},this._filter={},this._sort={},this._fields={},this._extra_fields={},this._include={},this._stats={},this._extraParams={},this._extraFetchOptions={},this.model=t}var Sr=($r.prototype.register=function(t,e){if(this._typeMap[t])throw new Error('Type "'+t+'" already registered on base class '+this._baseClass);this._typeMap[t]=e},$r.prototype.get=function(t){return this._typeMap[t]},$r);function $r(t){this._typeMap={},this._baseClass=t}var Rr=Object.prototype.toString;var Er=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},At=function(t,e,r){return e&&xr(t.prototype,e),r&&xr(t,r),t};function xr(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Fr(t){return t.split("").map(function(t){return"(?:"+t.toUpperCase()+"|"+t.toLowerCase()+")"}).join("")}function Dr(t,e){for(var r=t.length-1;0<=r;r--)t[r]===e&&Array.prototype.splice.call(t,r,1)}var Tr={},zr=(At(Ir,null,[{key:"getInstance",value:function(t){return Tr[t]=Tr[t]||new Ir,Tr[t]}}]),At(Ir,[{key:"acronym",value:function(t){this.acronyms[t.toLowerCase()]=t;var e,r,i=[];for(e in this.acronyms)r=this.acronyms,Object.prototype.hasOwnProperty.call(r,e)&&i.push(this.acronyms[e]);this.acronymRegex=new RegExp(i.join("|"))}},{key:"plural",value:function(t,e){"string"==typeof t&&Dr(this.uncountables,t),Dr(this.uncountables,e),this.plurals.unshift([t,e])}},{key:"singular",value:function(t,e){"string"==typeof t&&Dr(this.uncountables,t),Dr(this.uncountables,e),this.singulars.unshift([t,e])}},{key:"irregular",value:function(t,e){Dr(this.uncountables,t),Dr(this.uncountables,e);var r=t[0],i=t.substr(1),n=e[0],s=e.substr(1);r.toUpperCase()===n.toUpperCase()?(this.plural(new RegExp("("+r+")"+i+"$","i"),"$1"+s),this.plural(new RegExp("("+n+")"+s+"$","i"),"$1"+s),this.singular(new RegExp("("+r+")"+i+"$","i"),"$1"+i),this.singular(new RegExp("("+n+")"+s+"$","i"),"$1"+i)):(t=Fr(i),e=Fr(s),this.plural(new RegExp(r.toUpperCase()+t+"$"),n.toUpperCase()+s),this.plural(new RegExp(r.toLowerCase()+t+"$"),n.toLowerCase()+s),this.plural(new RegExp(n.toUpperCase()+e+"$"),n.toUpperCase()+s),this.plural(new RegExp(n.toLowerCase()+e+"$"),n.toLowerCase()+s),this.singular(new RegExp(r.toUpperCase()+t+"$"),r.toUpperCase()+i),this.singular(new RegExp(r.toLowerCase()+t+"$"),r.toLowerCase()+i),this.singular(new RegExp(n.toUpperCase()+e+"$"),r.toUpperCase()+i),this.singular(new RegExp(n.toLowerCase()+e+"$"),r.toLowerCase()+i))}},{key:"uncountable",value:function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];this.uncountables=this.uncountables.concat(e)}},{key:"human",value:function(t,e){this.humans.unshift([t,e])}},{key:"clear",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"all";"all"===t?(this.plurals=[],this.singulars=[],this.uncountables=[],this.humans=[]):this[t]=[]}}]),Ir);function Ir(){Er(this,Ir),this.plurals=[],this.singulars=[],this.uncountables=[],this.humans=[],this.acronyms={},this.acronymRegex=/(?=a)b/}var Lr,Mr={en:function(t){t.plural(/$/,"s"),t.plural(/s$/i,"s"),t.plural(/^(ax|test)is$/i,"$1es"),t.plural(/(octop|vir)us$/i,"$1i"),t.plural(/(octop|vir)i$/i,"$1i"),t.plural(/(alias|status)$/i,"$1es"),t.plural(/(bu)s$/i,"$1ses"),t.plural(/(buffal|tomat)o$/i,"$1oes"),t.plural(/([ti])um$/i,"$1a"),t.plural(/([ti])a$/i,"$1a"),t.plural(/sis$/i,"ses"),t.plural(/(?:([^f])fe|([lr])f)$/i,"$1$2ves"),t.plural(/(hive)$/i,"$1s"),t.plural(/([^aeiouy]|qu)y$/i,"$1ies"),t.plural(/(x|ch|ss|sh)$/i,"$1es"),t.plural(/(matr|vert|ind)(?:ix|ex)$/i,"$1ices"),t.plural(/^(m|l)ouse$/i,"$1ice"),t.plural(/^(m|l)ice$/i,"$1ice"),t.plural(/^(ox)$/i,"$1en"),t.plural(/^(oxen)$/i,"$1"),t.plural(/(quiz)$/i,"$1zes"),t.singular(/s$/i,""),t.singular(/(ss)$/i,"$1"),t.singular(/(n)ews$/i,"$1ews"),t.singular(/([ti])a$/i,"$1um"),t.singular(/((a)naly|(b)a|(d)iagno|(p)arenthe|(p)rogno|(s)ynop|(t)he)(sis|ses)$/i,"$1sis"),t.singular(/(^analy)(sis|ses)$/i,"$1sis"),t.singular(/([^f])ves$/i,"$1fe"),t.singular(/(hive)s$/i,"$1"),t.singular(/(tive)s$/i,"$1"),t.singular(/([lr])ves$/i,"$1f"),t.singular(/([^aeiouy]|qu)ies$/i,"$1y"),t.singular(/(s)eries$/i,"$1eries"),t.singular(/(m)ovies$/i,"$1ovie"),t.singular(/(x|ch|ss|sh)es$/i,"$1"),t.singular(/^(m|l)ice$/i,"$1ouse"),t.singular(/(bus)(es)?$/i,"$1"),t.singular(/(o)es$/i,"$1"),t.singular(/(shoe)s$/i,"$1"),t.singular(/(cris|test)(is|es)$/i,"$1is"),t.singular(/^(a)x[ie]s$/i,"$1xis"),t.singular(/(octop|vir)(us|i)$/i,"$1us"),t.singular(/(alias|status)(es)?$/i,"$1"),t.singular(/^(ox)en/i,"$1"),t.singular(/(vert|ind)ices$/i,"$1ex"),t.singular(/(matr)ices$/i,"$1ix"),t.singular(/(quiz)zes$/i,"$1"),t.singular(/(database)s$/i,"$1"),t.irregular("person","people"),t.irregular("man","men"),t.irregular("child","children"),t.irregular("sex","sexes"),t.irregular("move","moves"),t.irregular("zombie","zombies"),t.uncountable("equipment","information","rice","money","species","series","fish","sheep","jeans","police")}};function Ur(t,e){if("[object Function]"===Rr.call(t)&&(e=t,t=null),t=t||"en",!e)return zr.getInstance(t);e(zr.getInstance(t))}for(Lr in Mr)Ur(Lr,Mr[Lr]);function Nr(t,e){return function(t,e){var r,i,n=""+t;if(0===n.length)return n;if((t=n.toLowerCase().match(/\b\w+$/))&&-1<Ur().uncountables.indexOf(t[0]))return n;for(var s=0,o=e.length;s<o;s++)if(r=(i=e[s])[0],i=i[1],n.match(r)){n=n.replace(r,i);break}return n}(t,Ur(1<arguments.length&&void 0!==e?e:"en").plurals)}function Br(t){t=null==t?"":String(t);return t.charAt(0).toUpperCase()+t.slice(1)}function Jr(t,e){t=""+t;return t=(t=(e=null==e?!0:e)?t.replace(/^[a-z\d]*/,function(t){return Ur().acronyms[t]||Br(t)}):t.replace(new RegExp("^(?:"+Ur().acronymRegex.source+"(?=\\b|[A-Z_])|\\w)"),function(t){return t.toLowerCase()})).replace(/(?:_|(\/))([a-z\d]*)/gi,function(t,e,r,i,n){return""+(e=e||"")+(Ur().acronyms[r]||Br(r))})}function Kr(t){t=""+t;return(t=(t=(t=(t=t.replace(new RegExp("(?:([A-Za-z\\d])|^)("+Ur().acronymRegex.source+")(?=\\b|[^a-z])","g"),function(t,e,r){return(e||"")+(e?"_":"")+r.toLowerCase()})).replace(/([A-Z\d]+)([A-Z][a-z])/g,"$1_$2")).replace(/([a-z\d])([A-Z])/g,"$1_$2")).replace(/-/g,"_")).toLowerCase()}function Wr(t){return t.replace(/_/g,"-")}var Hr,qr={"Ã€":"A","Ã":"A","Ã‚":"A","Ãƒ":"A","Ã„":"A","Ã…":"A","Ã†":"AE","Ã‡":"C","Ãˆ":"E","Ã‰":"E","ÃŠ":"E","Ã‹":"E","ÃŒ":"I","Ã":"I","ÃŽ":"I","Ã":"I","Ã":"D","Ã‘":"N","Ã’":"O","Ã“":"O","Ã”":"O","Ã•":"O","Ã–":"O","Ã—":"x","Ã˜":"O","Ã™":"U","Ãš":"U","Ã›":"U","Ãœ":"U","Ã":"Y","Ãž":"Th","ÃŸ":"ss","Ã ":"a","Ã¡":"a","Ã¢":"a","Ã£":"a","Ã¤":"a","Ã¥":"a","Ã¦":"ae","Ã§":"c","Ã¨":"e","Ã©":"e","Ãª":"e","Ã«":"e","Ã¬":"i","Ã­":"i","Ã®":"i","Ã¯":"i","Ã°":"d","Ã±":"n","Ã²":"o","Ã³":"o","Ã´":"o","Ãµ":"o","Ã¶":"o","Ã¸":"o","Ã¹":"u","Ãº":"u","Ã»":"u","Ã¼":"u","Ã½":"y","Ã¾":"th","Ã¿":"y","Ä€":"A","Ä":"a","Ä‚":"A","Äƒ":"a","Ä„":"A","Ä…":"a","Ä†":"C","Ä‡":"c","Äˆ":"C","Ä‰":"c","ÄŠ":"C","Ä‹":"c","ÄŒ":"C","Ä":"c","ÄŽ":"D","Ä":"d","Ä":"D","Ä‘":"d","Ä’":"E","Ä“":"e","Ä”":"E","Ä•":"e","Ä–":"E","Ä—":"e","Ä˜":"E","Ä™":"e","Äš":"E","Ä›":"e","Äœ":"G","Ä":"g","Äž":"G","ÄŸ":"g","Ä ":"G","Ä¡":"g","Ä¢":"G","Ä£":"g","Ä¤":"H","Ä¥":"h","Ä¦":"H","Ä§":"h","Ä¨":"I","Ä©":"i","Äª":"I","Ä«":"i","Ä¬":"I","Ä­":"i","Ä®":"I","Ä¯":"i","Ä°":"I","Ä±":"i","Ä²":"IJ","Ä³":"ij","Ä´":"J","Äµ":"j","Ä¶":"K","Ä·":"k","Ä¸":"k","Ä¹":"L","Äº":"l","Ä»":"L","Ä¼":"l","Ä½":"L","Ä¾":"l","Ä¿":"L","Å€":"l","Å":"L","Å‚":"l","Åƒ":"N","Å„":"n","Å…":"N","Å†":"n","Å‡":"N","Åˆ":"n","Å‰":"'n","ÅŠ":"NG","Å‹":"ng","ÅŒ":"O","Å":"o","ÅŽ":"O","Å":"o","Å":"O","Å‘":"o","Å’":"OE","Å“":"oe","Å”":"R","Å•":"r","Å–":"R","Å—":"r","Å˜":"R","Å™":"r","Åš":"S","Å›":"s","Åœ":"S","Å":"s","Åž":"S","ÅŸ":"s","Å ":"S","Å¡":"s","Å¢":"T","Å£":"t","Å¤":"T","Å¥":"t","Å¦":"T","Å§":"t","Å¨":"U","Å©":"u","Åª":"U","Å«":"u","Å¬":"U","Å­":"u","Å®":"U","Å¯":"u","Å°":"U","Å±":"u","Å²":"U","Å³":"u","Å´":"W","Åµ":"w","Å¶":"Y","Å·":"y","Å¸":"Y","Å¹":"Z","Åº":"z","Å»":"Z","Å¼":"z","Å½":"Z","Å¾":"z","Ð":"A","Ð‘":"B","Ð’":"V","Ð“":"G","Ð”":"D","Ð•":"E","Ð":"E","Ð–":"ZH","Ð—":"Z","Ð˜":"I","Ð™":"J","Ðš":"K","Ð›":"L","Ðœ":"M","Ð":"N","Ðž":"O","ÐŸ":"P","Ð ":"R","Ð¡":"S","Ð¢":"T","Ð£":"U","Ð¤":"F","Ð¥":"KH","Ð¦":"C","Ð§":"CH","Ð¨":"SH","Ð©":"SHCH","Ðª":"","Ð«":"Y","Ð¬":"","Ð­":"E","Ð®":"YU","Ð¯":"YA","Ð°":"a","Ð±":"b","Ð²":"v","Ð³":"g","Ð´":"d","Ðµ":"e","Ñ‘":"e","Ð¶":"zh","Ð·":"z","Ð¸":"i","Ð¹":"j","Ðº":"k","Ð»":"l","Ð¼":"m","Ð½":"n","Ð¾":"o","Ð¿":"p","Ñ€":"r","Ñ":"s","Ñ‚":"t","Ñƒ":"u","Ñ„":"f","Ñ…":"kh","Ñ†":"c","Ñ‡":"ch","Ñˆ":"sh","Ñ‰":"shch","ÑŠ":"","Ñ‹":"y","ÑŒ":"","Ñ":"e","ÑŽ":"yu","Ñ":"ya"},Gr={};At(Zr,null,[{key:"getInstance",value:function(t){return Gr[t]=Gr[t]||new Zr,Gr[t]}}]),At(Zr,[{key:"approximate",value:function(t,e){this.approximations[t]=e}},{key:"transliterate",value:function(t,e){var r=this;return t.replace(/[^\u0000-\u007f]/g,function(t){return r.approximations[t]||e||"?"})}}]);function Zr(){for(var t in Er(this,Zr),this.approximations={},qr)this.approximate(t,qr[t])}(L=Hr=Hr||{})[L.debug=1]="debug",L[L.info=2]="info",L[L.warn=3]="warn",L[L.error=4]="error";var Vr={debug:1,info:2,warn:3,error:4};function Qr(t){void 0===t&&(t="warn"),this._level=Hr.info,"number"==typeof t?this._level=t:this.level=t}var Yr=new(Qr.prototype.debug=function(t){this._level<=Hr.debug&&console.info(t)},Qr.prototype.info=function(t){this._level<=Hr.info&&console.info(t)},Qr.prototype.warn=function(t){this._level<=Hr.warn&&console.warn(t)},Qr.prototype.error=function(t){this._level<=Hr.warn&&console.error(t)},Object.defineProperty(Qr.prototype,"level",{get:function(){for(var t in Hr)if(Hr.hasOwnProperty(t))if(Hr[t]===this._level)return t;throw new Error("Invalid log level: "+this._level)},set:function(t){t=Hr[t];if(!t)throw new Error("Log level must be one of "+Object.keys(Vr).join(", "));this._level=t},enumerable:!0,configurable:!0}),Qr);function Xr(r,i){return s(this,void 0,void 0,function(){var e;return u(this,function(t){switch(t.label){case 0:e=0,t.label=1;case 1:return e<r.length?[4,i(r[e],e,r)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e+=1,[3,1];case 4:return[2]}})})}var ti=(Object.defineProperty(ei.prototype,"beforeFilters",{get:function(){return this._beforeFilters},enumerable:!0,configurable:!0}),Object.defineProperty(ei.prototype,"afterFilters",{get:function(){return this._afterFilters},enumerable:!0,configurable:!0}),ei.prototype.beforeFetch=function(i,n){return s(this,void 0,void 0,function(){var r=this;return u(this,function(t){switch(t.label){case 0:return[4,Xr(this._beforeFilters,function(e){return s(r,void 0,void 0,function(){return u(this,function(t){switch(t.label){case 0:return[4,e(i,n)];case 1:return t.sent(),[2]}})})})];case 1:return t.sent(),[2]}})})},ei.prototype.afterFetch=function(i,n){return s(this,void 0,void 0,function(){var r=this;return u(this,function(t){switch(t.label){case 0:return[4,Xr(this._afterFilters,function(e){return s(r,void 0,void 0,function(){return u(this,function(t){switch(t.label){case 0:return[4,e(i,n)];case 1:return t.sent(),[2]}})})})];case 1:return t.sent(),[2]}})})},ei);function ei(t,e){void 0===t&&(t=[]),void 0===e&&(e=[]),this._beforeFilters=[],this._afterFilters=[],this._beforeFilters=t,this._afterFilters=e}function ri(t,e){for(var r in(e=n({},e)).credentialStorageBackend&&(t.credentialStorageBackend=e.credentialStorageBackend,delete e.jwtStorage),e.jwtStorage&&(t.jwtStorage=e.jwtStorage,delete e.jwtStorage),e.jwt&&(t.setJWT(e.jwt),delete e.jwt),e)e.hasOwnProperty(r)&&(t[r]=e[r]);void 0===t.isBaseClass?t.setAsBase():!0===t.isBaseClass&&(t.isBaseClass=!1)}var M=function(t,e){Object.defineProperty(t,e,{get:function(){},set:function(t){Object.defineProperty(this,e,{value:t,writable:!0,configurable:!0,enumerable:!1})},configurable:!0,enumerable:!1})},ii=(Object.defineProperty(ni,"credentialStorage",{get:function(){return this._credentialStorage},enumerable:!0,configurable:!0}),Object.defineProperty(ni,"jwtStorage",{get:function(){return this._jwtStorage},set:function(t){t!==this._jwtStorage&&(this._jwtStorage=t,this.credentialStorageBackend=this._credentialStorageBackend)},enumerable:!0,configurable:!0}),Object.defineProperty(ni,"credentialStorageBackend",{get:function(){return this._credentialStorageBackend},set:function(t){this._credentialStorageBackend=t,this._credentialStorage=new R(this.jwtStorage||"jwt",this._credentialStorageBackend)},enumerable:!0,configurable:!0}),ni.initializeCredentialStorage=function(){this.jwtStorage&&"undefined"!=typeof localStorage?this.credentialStorageBackend=localStorage:this.credentialStorageBackend=new S},ni.fromJsonapi=function(t,e){return r=this.typeRegistry,t=t,new fr(r,e).deserialize(t);var r},ni.inherited=function(t){t.parentClass=this,((t.currentClass=t).prototype.klass=t).attributeList=cr(t.attributeList),t.linkList=cr(t.linkList)},ni.setAsBase=function(){this.isBaseClass=!0,this.jsonapiType=void 0,this.typeRegistry||(this.typeRegistry=new Sr(this)),this.middlewareStack||(this._middlewareStack=new ti),this._IDMap||(this._IDMap=new pr)},ni.isSubclassOf=function(t){for(var e=this.currentClass;e;){if(e===t)return!0;e=e.parentClass}return!1},Object.defineProperty(ni,"baseClass",{get:function(){for(var t=this.currentClass;t;){if(t.isBaseClass)return t;t=t.parentClass}},enumerable:!0,configurable:!0}),Object.defineProperty(ni,"store",{get:function(){if(void 0===this.baseClass)throw new Error("No base class for "+this.name);return this.baseClass._IDMap},enumerable:!0,configurable:!0}),Object.defineProperty(ni,"typeRegistry",{get:function(){if(void 0===this.baseClass)throw new Error("No base class for "+this.name);return this.baseClass._typeRegistry},set:function(t){if(!this.isBaseClass)throw new Error("Cannot set a registry on a non-base class");this._typeRegistry=t},enumerable:!0,configurable:!0}),ni.registerType=function(){var t;this.jsonapiType&&((t=this.typeRegistry.get(this.jsonapiType))&&this.isSubclassOf(t)||this.typeRegistry.register(this.jsonapiType,this))},ni.extend=function(t){var e,r=(c(i,e=this),i);function i(){return null!==e&&e.apply(this,arguments)||this}this.inherited(r);var n,s={};if(t.attrs)for(var o in t.attrs)t.attrs.hasOwnProperty(o)&&((n=t.attrs[o]).name||(n.name=o),n.owner=r,s[o]=n);if(r.attributeList=Object.assign({},r.attributeList,s),r.linkList=r.linkList.slice(),ri(r,t.static||{}),r.registerType(),t.methods)for(var a in t.methods)t.methods.hasOwnProperty(a)&&(r.prototype[a]=t.methods[a]);return r},ni.prototype._initializeAttributes=function(){this._attributes={},this._copyPrototypeDescriptors()},ni.prototype._initializeLinks=function(){this._links={}},ni.prototype._copyPrototypeDescriptors=function(){var t,e,r=this,i=this.klass.attributeList;for(t in i)i.hasOwnProperty(t)&&(e=i[t],Object.defineProperty(this,t,e.descriptor()));["errors","isPersisted","isMarkedForDestruction","isMarkedForDisassociation"].forEach(function(t){var e=Object.getOwnPropertyDescriptor(ni.prototype,t);e&&Object.defineProperty(r,t,e)})},ni.prototype.isType=function(t){return this.klass.jsonapiType===t},Object.defineProperty(ni.prototype,"isPersisted",{get:function(){return this._persisted},set:function(t){(this._persisted=t)&&this.reset()},enumerable:!0,configurable:!0}),ni.prototype.onSyncRelationships=function(){var r=this;return this._onSyncRelationships||(this._onSyncRelationships=function(t,e){r.relationships=e},this._onSyncRelationships)},ni.prototype.onStoreChange=function(){var s=this;return this._onStoreChange||(this._onStoreChange=function(t,i){var n={};Object.keys(i).forEach(function(t){var e=s,r=s.changes();s.klass.attributeList[t].dirtyChecker(e[t],i[t])&&!r[t]&&(n[t]=[e[t],i[t]],e[t]=i[t],e._originalAttributes[t]=i[t])}),0<Object.keys(n).length&&void 0!==s.afterSync&&s.afterSync(n)},this._onStoreChange)},ni.prototype.unlisten=function(){var e=this;this.klass.sync&&(this.storeKey&&(lr.removeEventListener(this.storeKey,this.onStoreChange()),lr.removeEventListener(this.storeKey+"-sync-relationships",this.onSyncRelationships())),Object.keys(this.relationships).forEach(function(t){t=e.relationships[t];t&&(Array.isArray(t)?t.forEach(function(t){return t.unlisten()}):t.unlisten())}))},ni.prototype.listen=function(){this.klass.sync&&(this._onStoreChange||(lr.addEventListener(this.storeKey,this.onStoreChange()),lr.addEventListener(this.storeKey+"-sync-relationships",this.onSyncRelationships())))},ni.prototype.syncRelationships=function(){lr.dispatch(this.storeKey+"-sync-relationships",{},this.relationships)},ni.prototype.reset=function(){this.klass.sync&&(this.klass.store.updateOrCreate(this),this.listen()),this._originalAttributes=cr(this._attributes),this._originalRelationships=this.relationshipResourceIdentifiers(Object.keys(this.relationships))},ni.prototype.rollback=function(){this._attributes=cr(this._originalAttributes)},Object.defineProperty(ni.prototype,"isMarkedForDestruction",{get:function(){return this._markedForDestruction},set:function(t){this._markedForDestruction=t},enumerable:!0,configurable:!0}),Object.defineProperty(ni.prototype,"isMarkedForDisassociation",{get:function(){return this._markedForDisassociation},set:function(t){this._markedForDisassociation=t},enumerable:!0,configurable:!0}),Object.defineProperty(ni.prototype,"attributes",{get:function(){return this._attributes},set:function(t){this._attributes={},this.assignAttributes(t)},enumerable:!0,configurable:!0}),Object.defineProperty(ni.prototype,"stored",{get:function(){return this.klass.store.find(this)},enumerable:!0,configurable:!0}),Object.defineProperty(ni.prototype,"typedAttributes",{get:function(){return this._attributes},enumerable:!0,configurable:!0}),ni.prototype.relationship=function(t){return this.relationships[t]},ni.prototype.assignAttributes=function(t){if(t)for(var e in t)if(t.hasOwnProperty(e)){var r=this.klass.deserializeKey(e);if("id"===e||this.klass.attributeList[r])this[r]=t[e];else if(this.klass.strictAttributes)throw new Error("Unknown attribute: "+e)}},ni.prototype.setMeta=function(t,e){void 0===e&&(e=!0),this.__meta__=t,e&&(this._metaDirty=!0)},Object.defineProperty(ni.prototype,"meta",{get:function(){return this.__meta__||{}},enumerable:!0,configurable:!0}),Object.defineProperty(ni.prototype,"isMetaDirty",{get:function(){return this._metaDirty},enumerable:!0,configurable:!0}),ni.prototype.relationshipResourceIdentifiers=function(t){return r=this,i={},t.forEach(function(e){var t=r.relationship(e);t&&(t=!Array.isArray(t)?[t]:t).forEach(function(t){t.isPersisted&&(i[e]||(i[e]=[]),i[e].push(t.resourceIdentifier))})}),i;var r,i},ni.prototype.fromJsonapi=function(t,e,r){return i=t,void 0===(t=r=void 0===r?{}:r)&&(t={}),new fr((r=this).klass.typeRegistry,e).deserializeInstance(r,i,t);var i},Object.defineProperty(ni.prototype,"resourceIdentifier",{get:function(){if(void 0===this.klass.jsonapiType)throw new Error("Cannot build resource identifier for class. No JSONAPI Type specified.");return{id:this.id,type:this.klass.jsonapiType}},enumerable:!0,configurable:!0}),Object.defineProperty(ni.prototype,"errors",{get:function(){return this._errors},set:function(t){this._errors=t},enumerable:!0,configurable:!0}),Object.defineProperty(ni.prototype,"hasError",{get:function(){return!!Object.keys(this._errors).length},enumerable:!0,configurable:!0}),ni.prototype.clearErrors=function(){this.errors={}},ni.prototype.isDirty=function(t){return new br(this).check(t)},ni.prototype.changes=function(){return new br(this).dirtyAttributes()},ni.prototype.hasDirtyRelation=function(t,e){var r=new br(this);return!this.isPersisted||r.checkRelation(t,e)},ni.prototype.dup=function(){var t=Object.assign({},this.attributes,this.relationships),t=new this.klass(t);return t.id=this.id,t.isPersisted=this.isPersisted,t.isMarkedForDestruction=this.isMarkedForDestruction,t.isMarkedForDisassociation=this.isMarkedForDisassociation,t.errors=Object.assign({},this.errors),t.links=Object.assign({},this.links),t},ni.fetchOptions=function(){var t={credentials:"same-origin",headers:((e={Accept:"application/vnd.api+json"})["Content-Type"]="application/vnd.api+json",e)};this.credentials&&(t.credentials=this.credentials),this.clientApplication&&(t.headers["Client-Application"]=this.clientApplication);var e=this.getJWT();return e&&(t.headers.Authorization=this.generateAuthHeader(e)),t},ni.url=function(t){var e=this.endpoint||"/"+this.jsonapiType,e=""+this.fullBasePath()+e;return e=t?e+"/"+t:e},ni.fullBasePath=function(){return""+this.baseUrl+this.apiNamespace},Object.defineProperty(ni,"middlewareStack",{get:function(){if(this.baseClass){var t=this.baseClass._middlewareStack;if(this.beforeFetch||this.afterFetch){var e=this.beforeFetch?[this.beforeFetch]:t.beforeFilters,r=this.afterFetch?[this.afterFetch]:t.afterFilters;return new ti(e,r)}return t}return new ti},set:function(t){this._middlewareStack=t},enumerable:!0,configurable:!0}),ni.scope=function(){return new Pr(this)},ni.first=function(){return this.scope().first()},ni.all=function(){return this.scope().all()},ni.find=function(t){return this.scope().find(t)},ni.where=function(t){return this.scope().where(t)},ni.page=function(t){return this.scope().page(t)},ni.per=function(t){return this.scope().per(t)},ni.extraParams=function(t){return this.scope().extraParams(t)},ni.extraFetchOptions=function(t){return this.scope().extraFetchOptions(t)},ni.order=function(t){return this.scope().order(t)},ni.select=function(t){return this.scope().select(t)},ni.selectExtra=function(t){return this.scope().selectExtra(t)},ni.stats=function(t){return this.scope().stats(t)},ni.includes=function(t){return this.scope().includes(t)},ni.merge=function(t){return this.scope().merge(t)},ni.setJWT=function(t){this.credentialStorage.setJWT(t)},ni.getJWT=function(){return this.credentialStorage.getJWT()},Object.defineProperty(ni,"jwt",{get:function(){return this.getJWT()},set:function(t){this.setJWT(t)},enumerable:!0,configurable:!0}),ni.generateAuthHeader=function(t){return'Token token="'+t+'"'},ni.getJWTOwner=function(){return this.logger.warn("SpraypaintBase#getJWTOwner() is deprecated. Use #baseClass property instead"),this.baseClass},ni.serializeKey=function(t){switch(this.keyCase.server){case"dash":return Wr(Kr(t));case"snake":return Kr(t);case"camel":return Jr(Kr(t),!1)}},ni.deserializeKey=function(t){switch(this.keyCase.client){case"dash":return Wr(Kr(t));case"snake":return Kr(t);case"camel":return Jr(Kr(t),!1)}},ni.prototype.destroy=function(){return s(this,void 0,void 0,function(){var e,r,i,n=this;return u(this,function(t){switch(t.label){case 0:e=this.klass.url(this.id),r=new f(this._middleware(),this.klass.logger),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,r.delete(e,this._fetchOptions())];case 2:return i=t.sent(),[3,4];case 3:throw t.sent();case 4:return 202!==i.status?[3,6]:[4,this._handleAcceptedResponse(i,this.onDeferredDestroy)];case 5:return[2,t.sent()];case 6:return this.klass.baseClass.store.destroy(this),[4,this._handleResponse(i,function(){n.isPersisted=!1})];case 7:return[2,t.sent()]}})})},ni.prototype.save=function(c){return void 0===c&&(c={}),s(this,void 0,void 0,function(){var e,r,i,n,s,o,a=this;return u(this,function(t){switch(t.label){case 0:if(e=this.klass.url(),r="post",i=new f(this._middleware(),this.klass.logger,{patchAsPost:this.klass.patchAsPost}),n=new A(this,c.with),this.isPersisted&&(e=this.klass.url(this.id),r="patch"),c.returnScope){if((o=c.returnScope).model!==this.klass)throw new Error("returnScope must be a scope of type Scope<"+this.klass.name+">");e=e+"?"+o.toQueryParams()}this.clearErrors(),o=n.asJSON(),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,i[r](e,o,this._fetchOptions())];case 2:return s=t.sent(),[3,4];case 3:throw t.sent();case 4:return 202!==s.status&&204!==s.status?[3,6]:[4,this._handleAcceptedResponse(s,this.onDeferredUpdate)];case 5:return[2,t.sent()];case 6:return[4,this._handleResponse(s,function(){a.fromJsonapi(s.jsonPayload.data,s.jsonPayload,n.includeDirective),n.postProcess()})];case 7:return[2,t.sent()]}})})},ni.prototype._handleAcceptedResponse=function(r,i){return s(this,void 0,void 0,function(){var e;return u(this,function(t){switch(t.label){case 0:return r.jsonPayload&&i&&(e=this.klass.fromJsonapi(r.jsonPayload.data,r.jsonPayload),i(e)),[4,this._handleResponse(r,function(){})];case 1:return[2,t.sent()]}})})},ni.prototype._handleResponse=function(e,r){return s(this,void 0,void 0,function(){return u(this,function(t){if(a(this.klass,e),422!==e.status)return r(),[2,!0];try{o.apply(this,e.jsonPayload)}catch(t){throw new _(e,"validation failed",t)}return[2,!1]})})},ni.prototype._fetchOptions=function(){return this.klass.fetchOptions()},ni.prototype._middleware=function(){return this.klass.middlewareStack},ni.prototype.resetRelationTracking=function(t){this._originalRelationships=this.relationshipResourceIdentifiers(Object.keys(t))},Object.defineProperty(ni.prototype,"links",{get:function(){return this._links},set:function(t){this._links={},this.assignLinks(t)},enumerable:!0,configurable:!0}),ni.prototype.assignLinks=function(t){if(t)for(var e in t){var r=this.klass.deserializeKey(e);-1<this.klass.linkList.indexOf(r)&&(this._links[r]=t[e])}},ni.baseUrl="http://please-set-a-base-url.com",ni.apiNamespace="/",ni.keyCase={server:"snake",client:"camel"},ni.strictAttributes=!1,ni.logger=Yr,ni.sync=!1,ni.clientApplication=null,ni.patchAsPost=!1,ni.attributeList={},ni.linkList=[],(ni.currentClass=ni)._jwtStorage="jwt",ni.isSpraypaintModel=!0,e([M],ni.prototype,"afterSync",void 0),e([M],ni.prototype,"relationships",void 0),e([M],ni.prototype,"klass",void 0),e([M],ni.prototype,"_persisted",void 0),e([M],ni.prototype,"_markedForDestruction",void 0),e([M],ni.prototype,"_markedForDisassociation",void 0),e([M],ni.prototype,"_originalRelationships",void 0),e([M],ni.prototype,"_attributes",void 0),e([M],ni.prototype,"_originalAttributes",void 0),e([M],ni.prototype,"_links",void 0),e([M],ni.prototype,"_originalLinks",void 0),e([M],ni.prototype,"__meta__",void 0),e([M],ni.prototype,"_metaDirty",void 0),e([M],ni.prototype,"_errors",void 0),ni);function ni(t){this.stale=!1,this.storeKey="",this.relationships={},this._persisted=!1,this._markedForDestruction=!1,this._markedForDisassociation=!1,this._originalRelationships={},this._metaDirty=!1,this._errors={},this._initializeAttributes(),this._initializeLinks(),this.assignAttributes(t),this._originalAttributes=cr(this._attributes),this._originalLinks=cr(this._links),this._originalRelationships=this.relationshipResourceIdentifiers(Object.keys(this.relationships))}(ii.prototype.klass=ii).initializeCredentialStorage();function si(t){return!!t&&(t.currentClass&&t.currentClass.isSpraypaintModel)}function oi(t,e){return t!==e}var ai=(ci.prototype.apply=function(t){Object.defineProperty(t.prototype,this.name,this.descriptor())},ci.prototype.setter=function(t,e){t._attributes[this.name]=e},ci.prototype.getter=function(t){return t.attributes[this.name]},ci.prototype.descriptor=function(){var e=this;return{configurable:!0,enumerable:!0,get:function(){return e.getter(this)},set:function(t){e.setter(this,t)}}},ci);function ci(t){this.isRelationship=!1,this.type=void 0,this.persist=!0,this.dirtyChecker=oi,t&&(t.name&&(this.name=t.name),t.type&&(this.type=t.type),void 0!==t.persist&&(this.persist=!!t.persist),t.dirtyChecker&&(this.dirtyChecker=t.dirtyChecker))}function ui(t){return!!t.klass.sync&&((t.isPersisted||t.stale)&&!t.stored)}var li,At=(c(pi,li=ai),Object.defineProperty(pi.prototype,"klass",{get:function(){return this._klass||(this._klass=wi(this,this.jsonapiType)),this._klass},enumerable:!0,configurable:!0}),pi.prototype.getter=function(t){var e=t.relationships[this.name];return e&&ui(e)&&delete t.relationships[this.name],t.relationships[this.name]},pi.prototype.setter=function(t,e){e&&!e.hasOwnProperty("isRelationship")?(e instanceof ii||Array.isArray(e)||(e=new this.klass(e)),t.relationships[this.name]=e):null==e&&(t.relationships[this.name]=e)},pi);function pi(t){var e=li.call(this,t)||this;return e.isRelationship=!0,t.jsonapiType&&(e.jsonapiType=t.jsonapiType),e.type&&(e._klass=e.type),e}var hi,fi=(c(di,hi=ai),Object.defineProperty(di.prototype,"klass",{get:function(){return this._klass||(this._klass=wi(this,this.jsonapiType)),this._klass},enumerable:!0,configurable:!0}),di.prototype.getter=function(t){var e=t.relationships[this.name];if(!e)return this.setter(t,[]),t.relationships[this.name];for(var r=e.length;r--;)ui(e[r])&&(t.relationships[this.name],e.splice(r,1));return t.relationships[this.name]},di.prototype.setter=function(t,e){e&&!e.hasOwnProperty("isRelationship")?(e instanceof ii||Array.isArray(e)||(e=new this.klass(e)),t.relationships[this.name]=e):null==e&&(t.relationships[this.name]=e)},di);function di(t){var e=hi.call(this,t)||this;return e.isRelationship=!0,t.jsonapiType&&(e.jsonapiType=t.jsonapiType),e.type&&(e._klass=e.type),e}var yi,bi=(c(vi,yi=At),vi);function vi(){return null!==yi&&yi.apply(this,arguments)||this}var gi,_i=(c(mi,gi=At),mi);function mi(){return null!==gi&&gi.apply(this,arguments)||this}var ji=function(t){var e={};return void 0!==t&&("string"==typeof t?e={jsonapiType:t}:(e={persist:t.persist,name:t.name},"string"==typeof t.type?e.jsonapiType=t.type:e.type=t.type)),e},wi=function(t,e){t=t.owner.typeRegistry.get(e);if(t)return t;throw new Error('Unknown type "'+e+'"')},Oi="undefined"!=typeof window,ki=!("production"===process.env.NODE_ENV);function Ai(t){return t&&void 0!==t.kind}var Pi=function(t,e){Ci(t),ri(t,e||{}),t.jsonapiType||t.isBaseClass||(t.jsonapiType=Nr(Kr(t.name)),ki&&Oi&&Yr.warn('Inferring model jsonapiType as "'+t.jsonapiType+'".\nYou should explicitly set this on your model if targeting a minified code bundle.')),t.registerType()},Ci=function(t){t.currentClass!==t&&t.currentClass.inherited(t)},L=function(o){return function(r,t,n){function i(t,e){void 0===n?(i=Nr(Kr(e)),s={jsonapiType:i}):"string"==typeof n?s={jsonapiType:n}:si(n)?s={type:n}:(s={persist:n.persist,name:n.name},"string"==typeof n.type?s.jsonapiType=n.type:s.type=n.type);var r=new o(s);r.name||(r.name=e);var i=(i=t.constructor,Ci(i),i);return(i.attributeList[e]=r).owner=t.constructor,r.apply(i),r.descriptor()}var s;if(Ai(r))return Object.assign(r,{finisher:function(t){i(t.prototype,r.key)}});if(!si(r)||!t)return function(e,t){return Ai(e)?Object.assign(e,{finisher:function(t){i(t.prototype,e.key)}}):(n=r,i(e,t))};i(r.prototype,t)}},M=L(fi),At=L(bi),L=L(_i);t.SpraypaintBase=ii,t.Attribute=ai,t.attr=function(t){return new ai(t=t||{})},t.hasMany=function(t){t=ji(t);return new fi(t)},t.hasOne=function(t){t=ji(t);return new bi(t)},t.belongsTo=function(t){t=ji(t);return new _i(t)},t.Model=function(e){return r=function(t){return Pi(t,e),t},function(t){return Ai(t)?Object.assign(t,{finisher:r}):r(t)};var r},t.Attr=function(e,t,r){function i(t,e){return Ci(t),n.name||(n.name=e),(t.attributeList[e]=n).apply(t),n.descriptor()}var n=new ai({name:t});if(Ai(e))return Object.assign(e,{finisher:function(t){i(t,e.key)}});if(!(si(e)||(s=e)&&si(s.constructor.currentClass)))return e&&(n=new ai(e)),function(t,e){return i(t.constructor,e)};if(!t)throw new Error("Must provide a propertyKey");var s,s=e;if(!si(s))return i(s.constructor,t);r&&(n=new ai(r)),i(s,t)},t.HasMany=M,t.HasOne=At,t.BelongsTo=L,t.Link=function(e){function r(t,e){Ci(t),t.linkList.push(e)}return Ai(e)?Object.assign(e,{finisher:function(t){r(t,e.key)}}):function(t,e){r(t.constructor,e)}},t.MiddlewareStack=ti,t.Scope=Pr,t.Request=f,Object.defineProperty(t,"__esModule",{value:!0})});
